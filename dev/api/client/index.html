<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Client · MQTTClient.jl</title><meta name="title" content="Client · MQTTClient.jl"/><meta property="og:title" content="Client · MQTTClient.jl"/><meta property="twitter:title" content="Client · MQTTClient.jl"/><meta name="description" content="Documentation for MQTTClient.jl."/><meta property="og:description" content="Documentation for MQTTClient.jl."/><meta property="twitter:description" content="Documentation for MQTTClient.jl."/><meta property="og:url" content="https://JuliaMessaging.github.io/MQTTClient.jl/api/client/"/><meta property="twitter:url" content="https://JuliaMessaging.github.io/MQTTClient.jl/api/client/"/><link rel="canonical" href="https://JuliaMessaging.github.io/MQTTClient.jl/api/client/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MQTTClient.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting-started/">Getting Started</a></li><li><a class="tocitem" href="../../interfaces/">MQTT Interface Functions</a></li><li><a class="tocitem" href="../../client/">MQTT Client</a></li><li><span class="tocitem">MQTT API</span><ul><li class="is-active"><a class="tocitem" href>Client</a></li><li><a class="tocitem" href="../interface/">Interfacing Functions</a></li></ul></li><li><a class="tocitem" href="../../utils/">Utils</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">MQTT API</a></li><li class="is-active"><a href>Client</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Client</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaMessaging/MQTTClient.jl/blob/main/docs/src/api/client.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MQTTClient.Client" href="#MQTTClient.Client"><code>MQTTClient.Client</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Client</code></pre><p>The MQTT client in Julia facilitates communication between a device and an MQTT broker over a network. It manages connections, message handling, and maintains the state of communication. The client operates through three main loops: the read loop listens for incoming messages from the broker and processes them using designated handlers; the write loop sends packets to the broker from a queue, ensuring thread safety with a socket lock; and the keep-alive loop periodically sends ping requests to the broker to maintain the connection and detect disconnections. This client uses atomic operations to ensure thread safety for shared variables and supports asynchronous task management for efficient, non-blocking operations.</p><p><strong>Fields</strong></p><ul><li><code>state::UInt8</code>: client state.</li><li><code>on_msg::TrieNode</code>: A trie mapping topics to callback functions.</li><li><code>keep_alive::UInt16</code>: The keep-alive time in seconds.</li><li><code>last_id::UInt16</code>: The last packet identifier used.</li><li><code>in_flight::Dict{UInt16, Future}</code>: A dictionary mapping packet identifiers to futures.</li><li><code>write_packets::AbstractChannel</code>: A channel for writing packets.</li><li><code>socket</code>: The socket used for communication with the broker.</li><li><code>socket_lock</code>: A lock for synchronizing access to the socket.</li><li><code>ping_timeout::UInt64</code>: The ping timeout in seconds.</li><li><code>ping_outstanding::Atomic{UInt8}</code>: An atomic counter for the number of outstanding ping requests.</li><li><code>last_sent::Atomic{Float64}</code>: An atomic float representing the timestamp of the last sent packet.</li><li><code>last_received::Atomic{Float64}</code>: An atomic float representing the timestamp of the last received packet.</li></ul><p><strong>Constructor</strong></p><p><code>Client(ping_timeout::UInt64=UInt64(60))</code> constructs a new <code>Client</code> object with the specified ping timeout (default: 60 seconds).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMessaging/MQTTClient.jl/blob/23f5429e26bf6d69af1debabf53a0ffc7c3f0177/src/client.jl#L1-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MQTTClient.Connection" href="#MQTTClient.Connection"><code>MQTTClient.Connection</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Connection{T &lt;: AbstractIOConnection}</code></pre><p>The <code>Connection</code> struct in Julia encapsulates the configuration and connection details required for an MQTT client to connect to an MQTT broker. This struct supports two types of connection protocols: TCP and Unix Domain Sockets (UDS), both of which are subtypes of <code>AbstractIOConnection</code>. The struct includes fields for protocol type, keep-alive interval, client ID, user credentials, a will message (a message that is sent by the broker if the client disconnects unexpectedly), and a flag indicating whether the session is clean (i.e., no persistent session state). The <code>Connection</code> constructor allows for flexible instantiation with default or specified values for each field, enabling easy setup of connection parameters tailored to the specific requirements of the MQTT client and broker interaction.</p><p><strong>Fields</strong></p><ul><li><code>protocol::T</code>: The underlying IO connection.</li><li><code>keep_alive::Int64</code>: The keep-alive time in seconds.</li><li><code>client_id::String</code>: The client identifier.</li><li><code>user::User</code>: The user credentials.</li><li><code>will::Message</code>: The last will and testament message.</li><li><code>clean_session::Bool</code>: Whether to start a clean session.</li></ul><p><strong>Constructors</strong></p><p><code>Connection(protocol::T; keep_alive::Int64=32, client_id::String=randstring(8), user::User=User(&quot;&quot;, &quot;&quot;), will::Message=Message(false, 0x00, false, &quot;&quot;, UInt8[]), clean_session::Bool=true) where T &lt;: AbstractIOConnection</code> constructs a new <code>Connection</code> object with the specified protocol and optional keyword arguments.</p><p><code>Connection(protocol::T, keep_alive::Int64, client_id::String, user::User, will::Message, clean_session::Bool) where T &lt;: AbstractIOConnection</code> constructs a new <code>Connection</code> object with the specified arguments.</p><p><strong>Example using TCP protocol with default and custom values</strong></p><pre><code class="language-julia hljs">tcp_connection = Connection(
    TCP(Sockets.localhost, 1883);       # Using TCP with localhost and port 1883
    keep_alive=60,                      # Custom keep-alive interval of 60 seconds
    client_id=&quot;my_mqtt_client&quot;,         # Custom client ID
    user=User(&quot;username&quot;, &quot;password&quot;),  # Custom user credentials
    will=Message(false, 0x01, false, &quot;last/will/topic&quot;, UInt8[]),  # Custom will message
    clean_session=true,                  # Default clean session flag
)</code></pre><p><strong>Example using UDS protocol with all custom values</strong></p><pre><code class="language-julia hljs">uds_connection_full = Connection(
    UDS(&quot;/var/run/mqtt.sock&quot;),          # Using UDS with specified socket path
    45,                                 # Custom keep-alive interval of 45 seconds
    &quot;another_client&quot;,                   # Custom client ID
    User(&quot;user&quot;, &quot;pass&quot;),               # Custom user credentials
    Message(true, 0x00, true, &quot;will/topic&quot;, UInt8[1, 2, 3]),  # Custom will message
    false,                               # Custom clean session flag
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMessaging/MQTTClient.jl/blob/23f5429e26bf6d69af1debabf53a0ffc7c3f0177/src/connection.jl#L72-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MQTTClient.IOConnection" href="#MQTTClient.IOConnection"><code>MQTTClient.IOConnection</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">IOConnection(ip::IPAddr, port::Int64)</code></pre><p>Constructs a new <code>TCP</code> object with the specified IP address and port number.</p><p><strong>Arguments</strong></p><ul><li><code>ip::IPAddr</code>: The IP address of the remote host.</li><li><code>port::Int64</code>: The port number on the remote host.</li></ul><p><strong>Returns</strong></p><ul><li><p><code>TCP</code>: A new <code>TCP</code> object.</p></li><li><ul><li><ul><li></li></ul></li></ul><p>IOConnection(ip::String, port::Int64)</p></li></ul><p>Constructs a new <code>TCP</code> object with the specified IP address and port number.</p><p><strong>Arguments</strong></p><ul><li><code>ip::String</code>: The IP address of the remote host as a string.</li><li><code>port::Int64</code>: The port number on the remote host.</li></ul><p><strong>Returns</strong></p><ul><li><p><code>TCP</code>: A new <code>TCP</code> object.</p></li><li><ul><li><ul><li></li></ul></li></ul><p>IOConnection(path::AbstractString)</p></li></ul><p>Constructs a new <code>UDS</code> object with the specified file system path.</p><p><strong>Arguments</strong></p><ul><li><code>path::AbstractString</code>: The file system path of the socket.</li></ul><p><strong>Returns</strong></p><ul><li><code>UDS</code>: A new <code>UDS</code> object.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMessaging/MQTTClient.jl/blob/23f5429e26bf6d69af1debabf53a0ffc7c3f0177/src/connection.jl#L12-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MQTTClient.Message" href="#MQTTClient.Message"><code>MQTTClient.Message</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Message</code></pre><p>A composite type representing a message.</p><p><strong>Fields</strong></p><ul><li><code>dup::Bool</code>: a boolean indicating whether the message is a duplicate.</li><li><code>qos::UInt8</code>: an 8-bit unsigned integer representing the quality of service.</li><li><code>retain::Bool</code>: a boolean indicating whether the message should be retained.</li><li><code>topic::String</code>: a string representing the topic.</li><li><code>payload::Array{UInt8}</code>: an array of 8-bit unsigned integers representing the payload.</li></ul><p><strong>Constructors</strong></p><ul><li><code>Message(qos::QOS, topic::String, payload...)</code>: constructs a new message with default values for <code>dup</code> and <code>retain</code>.</li><li><code>Message(dup::Bool, qos::QOS, retain::Bool, topic::String, payload...)</code>: constructs a new message with all fields specified.</li><li><code>Message(dup::Bool, qos::UInt8, retain::Bool, topic::String, payload...)</code>: constructs a new message with all fields specified.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMessaging/MQTTClient.jl/blob/23f5429e26bf6d69af1debabf53a0ffc7c3f0177/src/internals.jl#L64-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MQTTClient.User" href="#MQTTClient.User"><code>MQTTClient.User</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">User(name::String, password::String)</code></pre><p>A struct that represents a user with a name and password.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">user = User(&quot;John&quot;, &quot;password&quot;)

User(&quot;John&quot;, &quot;password&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMessaging/MQTTClient.jl/blob/23f5429e26bf6d69af1debabf53a0ffc7c3f0177/src/internals.jl#L117-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MQTTClient.Configuration" href="#MQTTClient.Configuration"><code>MQTTClient.Configuration</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Configuration</code></pre><p>Container for the mqtt client and mqtt connection data. This is partially iterable, and can be spread to 2 variables with the <code>...</code> splat operator or <code>client, conn = conf</code> variable assignment.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs"># using the MakeConnection interface function
config = MakeConnection(&quot;/temp/mqtt.sock&quot;)

# using a defined IO
io = IOConnection(&quot;localhost&quot;, 1883)
config = Configuration(io)

# spreading the variables
client, connection = Configuration(...)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaMessaging/MQTTClient.jl/blob/23f5429e26bf6d69af1debabf53a0ffc7c3f0177/src/connection.jl#L163-L181">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../client/">« MQTT Client</a><a class="docs-footer-nextpage" href="../interface/">Interfacing Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 9 July 2024 19:56">Tuesday 9 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
